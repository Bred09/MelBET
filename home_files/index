function CurrencyIconFaClass(n){return n==="3"?"fa-rub":n==="6"?"fa-usd":""}function initAreasGraphs(n){var i=[],r=[],u=[],f=[],e=[],o=[],h=n.report.length,t=[["week",[1]],["month",[1]]],s;n.report.forEach(function(n){const t=moment(n.period_data).utc().add(3,"hours").valueOf();i.push([t,n.Views]);r.push([t,n.Clicks]);u.push([t,n.DirectLink]);f.push([t,n.Regs]);e.push([t,n.NewAccDeposit]);o.push([t,n.ComissionSum])});s=Highcharts.stockChart("Chart_1",{credits:{enabled:!1},rangeSelector:{selected:3,inputEnabled:!1,buttons:[{type:"week",count:1,text:"1"+$.localize("w","~/Scripts/build/1_2/partner/index.js")},{type:"month",count:1,text:"1"+$.localize("m","~/Scripts/build/1_2/partner/index.js")},{type:"all",text:$.localize("All","~/Scripts/main.js")}]},yAxis:[{labels:{align:"right",x:-3},height:"30%",lineWidth:2,showEmpty:!1},{labels:{align:"right",x:-3},top:"33%",height:"30%",offset:0,lineWidth:2,showEmpty:!1},{labels:{align:"right",x:-3},top:"66%",height:"30%",offset:0,lineWidth:2,showEmpty:!1}],legend:{enabled:!0,align:"center",floating:!1,itemMarginTop:5,itemMarginBottom:5,symbolRadius:0,borderWidth:0,verticalAlign:"bottom"},tooltip:{split:!0,xDateFormat:"%A, %b %e"},colors:[projectConstants.TENANT_STYLE_UI_COLORS[4],projectConstants.TENANT_STYLE_UI_COLORS[3],projectConstants.TENANT_STYLE_UI_COLORS[1]],plotOptions:{area:{events:{legendItemClick:function(n){var i=[],t;n.target.visible!==!0&&i.push(n.target.index);$.each(n.target.chart.legend.allItems,function(t,r){r.index!==n.target.index&&r.visible===!0&&i.push(r.index)});var u=Math.floor((100-1*i.length)/i.length),r=0;for(t=0;t<n.target.chart.yAxis.length;t++)t<3&&i.indexOf(t)!==-1&&(n.target.chart.yAxis[t].update({height:u+"%",top:r===0?"0%":(u+1)*r+"%"}),r++)}}}},series:[{type:"area",name:$.localize("Views","~/bundles/1_2/main.js"),data:i,dataGrouping:{units:t}},{type:"area",name:$.localize("Clicks","~/bundles/1_2/main.js"),data:r,yAxis:1,dataGrouping:{units:t}},{type:"area",name:$.localize("Direct links","~/bundles/1_2/main.js"),data:u,yAxis:2,dataGrouping:{units:t}}],responsive:{rules:[{condition:{maxWidth:400},chartOptions:{subtitle:{text:null},navigator:{enabled:!1},yAxis:[{title:{text:null}},{title:{text:null}},{title:{text:null}}]}}]}});Highcharts.stockChart("Chart_2",{credits:{enabled:!1},rangeSelector:{selected:3,inputEnabled:!1,buttons:[{type:"week",count:1,text:"1"+$.localize("w","~/Scripts/build/1_2/partner/index.js")},{type:"month",count:1,text:"1"+$.localize("m","~/Scripts/build/1_2/partner/index.js")},{type:"all",text:$.localize("All","~/Scripts/main.js")}]},yAxis:[{labels:{align:"right",x:-3},height:"30%",lineWidth:2},{labels:{align:"right",x:-3},top:"33%",height:"30%",offset:0,lineWidth:2},{labels:{align:"right",x:-3},top:"66%",height:"30%",offset:0,lineWidth:2}],legend:{enabled:!0,align:"center",floating:!1,itemMarginTop:5,itemMarginBottom:5,symbolRadius:0,borderWidth:0,verticalAlign:"bottom"},plotOptions:{area:{events:{legendItemClick:function(n){var i=[],t;n.target.visible!==!0&&i.push(n.target.index);$.each(n.target.chart.legend.allItems,function(t,r){r.index!==n.target.index&&r.visible===!0&&i.push(r.index)});var u=Math.floor((100-1*i.length)/i.length),r=0;for(t=0;t<n.target.chart.yAxis.length;t++)t<3&&i.indexOf(t)!==-1&&(n.target.chart.yAxis[t].update({height:u+"%",top:r===0?"0%":(u+1)*r+"%"}),r++)}}}},tooltip:{split:!0,xDateFormat:"%A, %b %e"},colors:[projectConstants.TENANT_STYLE_UI_COLORS[5],projectConstants.TENANT_STYLE_UI_COLORS[0],projectConstants.TENANT_STYLE_UI_COLORS[2]],series:[{type:"area",name:$.localize("Registrations","~/bundles/1_2/main.js"),data:f,dataGrouping:{units:t}},{type:"area",name:$.localize("New depositors","~/bundles/1_2/main.js"),data:e,yAxis:1,dataGrouping:{units:t}},{type:"area",name:$.localize("Commission amount","~/bundles/1_2/main.js"),data:o,yAxis:2,dataGrouping:{units:t}}],responsive:{rules:[{condition:{maxWidth:400},chartOptions:{subtitle:{text:null},navigator:{enabled:!1},yAxis:[{title:{text:null}},{title:{text:null}},{title:{text:null}}]}}]}})}function UpdatePayments(n){const t=$("#s_valuta2").val();$("#total_sum, #tomorrow_sum, #7_sum, #30_sum, #payment_sum").removeClass("fa-rub fa-usd");$("#total_sum, #tomorrow_sum, #7_sum, #30_sum, #payment_sum").addClass(CurrencyIconFaClass(t));$("#total_sum + div").text(n.SUM_CURRENT);$("#tomorrow_sum + div").text(n.SUM_Yesterday);$("#7_sum + div").text(n.SUM_MOUNTH_CUR);$("#30_sum + div").text(n.SUM_MOUNTH);$("#payment_sum + div").text(n.SUM_TAKE)}function GetPartnerPayment(){return!0}function GetPartnerPaymentSucces(n){n.report.length!=0?UpdatePayments(n.report[0]):null}function GetPartnerPaymentFail(){}function GetPartnerGraph(){return!0}function GetPartnerGraphSucces(n){initAreasGraphs(n)}function GetPartnerGraphFail(){}function UpdatePartnerGraph(){const n=$("#s_period option:selected").val(),t=$("#s_valuta2 option:selected").val();var i=n==2||n==1?0:1;$("#formPartnerQraph input#type_otchet").val(i);$("#formPartnerQraph input#Period").val(n);$("#formPartnerQraph input#MerchantId, #formPartnerPayment input#MerchantId").val(t);$("#formPartnerPayment").submit();$("#formPartnerQraph").submit()}function ClearPartnerCache(){$.ajax({url:"/Partner/ClearPartnerCache",type:"POST",data:JSON.stringify({}),dataType:"json",contentType:"application/json; charset=utf-8",error:function(){console.log("The request failed")},success:function(){$("#quick_report").DataTable().ajax.reload();UpdatePartnerGraph();$("#refresh").removeClass("animate")},async:!0,processData:!1})}function OpenPopupEvent(n,t,i){var r=getCookie(n);!!r&&r*1<t?(setCookie(n,JSON.stringify(r*1+1),{expires:2592e3,path:"/"}),$.fancybox.open({src:"#modal-"+i,animationEffect:"zoom-in-out",animationDuration:300})):!!r&&r*1>=t?setCookie(n,JSON.stringify(r*1),{expires:new Date(2038,0,31),path:"/"}):(setCookie(n,JSON.stringify(1),{expires:2592e3,path:"/"}),$.fancybox.open({src:"#modal-"+i,animationEffect:"zoom-in-out",animationDuration:300}))}function OpenPopupBlockReferrence(n,t="",i=0){if($.fancybox.open({src:"#modal-attention"+t,animationEffect:"zoom-in-out",animationDuration:300,mobile:{clickContent:function(n,i){($(i.target).prop("tagName").toLowerCase()==="label"||$(i.target).prop("tagName").toLowerCase()==="span")&&$(i.target).closest(".ui-check").children("#DisableModal"+t).length>0&&($("#DisableModal"+t).prop("checked",!$("#DisableModal"+t).prop("checked")),$("#DisableModal"+t).triggerHandler("click"))}}}),i!==0){var r=getCookie(n);!!r&&r*1<i?setCookie(n,JSON.stringify(r*1+1),{expires:2592e3,path:"/"}):!!r&&r*1>=i?setCookie(n,JSON.stringify(r*1),{expires:new Date(2038,0,31),path:"/"}):setCookie(n,JSON.stringify(1),{expires:2592e3,path:"/"})}}function PopupDisableModalChecked(n="",t=0){t!==0?setCookie(n,JSON.stringify(t*1),{expires:new Date(2038,0,31),path:"/"}):(date=new Date,date.setTime(date.getTime()+2592e7),document.cookie=n+"=true; expires="+date.toUTCString())}function PopupDisableModalUnChecked(n="",t=0){t!==0?setCookie(n,JSON.stringify(t*1-1),{expires:new Date(2038,0,31),path:"/"}):document.cookie=n+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}Highcharts.setOptions({lang:{rangeSelectorZoom:$.localize("Zoom","~/Scripts/build/1_2/partner/index.js"),months:[$.localize("January","~/Scripts/main.js"),$.localize("February","~/Scripts/main.js"),$.localize("March","~/Scripts/main.js"),$.localize("April","~/Scripts/main.js"),$.localize("May","~/Scripts/main.js"),$.localize("June","~/Scripts/main.js"),$.localize("July","~/Scripts/main.js"),$.localize("August","~/Scripts/main.js"),$.localize("September","~/Scripts/main.js"),$.localize("October","~/Scripts/main.js"),$.localize("November","~/Scripts/main.js"),$.localize("December","~/Scripts/main.js")],shortMonths:[$.localize("Jan","~/Scripts/main.js"),$.localize("Feb","~/Scripts/main.js"),$.localize("Mar","~/Scripts/main.js"),$.localize("Apr","~/Scripts/main.js"),$.localize("May","~/Scripts/main.js"),$.localize("Jun","~/Scripts/main.js"),$.localize("Jul","~/Scripts/main.js"),$.localize("Aug","~/Scripts/main.js"),$.localize("Sep","~/Scripts/main.js"),$.localize("Oct","~/Scripts/main.js"),$.localize("Nov","~/Scripts/main.js"),$.localize("Dec","~/Scripts/main.js")],weekdays:[$.localize("Sunday","~/Scripts/main.js"),$.localize("Monday","~/Scripts/main.js"),$.localize("Tuesday","~/Scripts/main.js"),$.localize("Wednesday","~/Scripts/main.js"),$.localize("Thursday","~/Scripts/main.js"),$.localize("Friday","~/Scripts/main.js"),$.localize("Saturday","~/Scripts/main.js")],shortWeekdays:[$.localize("Su","~/Scripts/main.js"),$.localize("Mo","~/Scripts/main.js"),$.localize("Tu","~/Scripts/main.js"),$.localize("We","~/Scripts/main.js"),$.localize("Th","~/Scripts/main.js"),$.localize("Fr","~/Scripts/main.js"),$.localize("Sa","~/Scripts/main.js")]}});$(document).ready(function(){var t=setTimeout(function(){},0),n=!1,u;const r=$("#s_valuta2").val(),f=CurrencyIconFaClass(r);$("#total_sum, #tomorrow_sum, #7_sum, #30_sum, #payment_sum").addClass(f);const i=$("#s_period option:selected").val();$("#formPartnerQraph input#MerchantId, #formPartnerPayment input#MerchantId").val(r);u=i==2||i==1?0:1;$("#formPartnerQraph input#type_otchet").val(u);$("#formPartnerQraph input#Period").val(i);$("#formPartnerQraph").submit();$("#formPartnerPayment").submit();$("#btnFilterChartChange").on("click",function(){UpdatePartnerGraph()});$("#refresh").on("click",function(){$(this).addClass("animate");ClearPartnerCache()});defaultDTConfig.columnDefs=[{className:"control table__cell table__cell_xs",orderable:!1,targets:0},{type:"currency",targets:[6,8,9,10]},{targets:"_all",className:"table__cell"}];defaultDTConfig.order=[[1,"asc"]];defaultDTConfig.createdRow=function(n){$("tr",n).addClass("table__row")};defaultDTConfig.processing=!0;defaultDTConfig.paging=!1;defaultDTConfig.searching=!1;defaultDTConfig.ajax={url:"/Partner/GetPartnerQuickReport",type:"POST",async:!0,data:function(n){n.Period=$("#quick_period").val();n.__RequestVerificationToken=$("#formPartnerQuickReport input[name='__RequestVerificationToken']").val()},beforeSend:function(){n=!0;$("#quick_report").DataTable().processing(!0)},dataSrc:function(n){return n.report},error:function(i){console.log("Ajax failed. Status: ",i.status);n=!1;i.status!==504||n?(noty({text:"Server Error",type:"error"}),$("#quick_report").DataTable().processing(!1)):(n=!0,!t||(clearTimeout(t),t=setTimeout(function(){$("#quick_report").DataTable().ajax.reload()},0)))}};defaultDTConfig.columns=[{data:null,defaultContent:""},{data:"name_val"},{data:"Views"},{data:"Clicks"},{data:"DirectLink"},{data:"Regs"},{data:"NewAccDeposit"},{data:"Profit",render:function(n,t,i){return FormatCurrency(n,i.name_val)}},{data:"ComissionSum",render:function(n,t,i){return FormatCurrency(n,i.name_val)}},{data:"CPA",render:function(n,t,i){return FormatCurrency(n,i.name_val)}},{data:"ItogComission",render:function(n,t,i){return FormatCurrency(n,i.name_val)}}];$("#quick_report").dataTable(defaultDTConfig);$("#quick_period").on("change",function(){$("#quick_report").DataTable().ajax.reload()})})